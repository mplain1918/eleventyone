---
title: Test
permalink: '/foo/index.html'
layout: layouts/base.njk
---
<h2>Test</h2>
<form action="post">
  <input type="file" id="file-selector" multiple accept=".jpg, .jpeg, .png">
  <button>Submit</button>
</form>

<ul class="js-file-data">
</ul>

<!-- The `multiple` attribute lets users select multiple files. -->
<script defer>
  document.querySelector('form').addEventListener('submit', (e) => {
    e.preventDefault()

    const file = document.querySelector('[type="file"]').files[0]
    const fd = new FormData()
    fd.append('file', file);

    fetch('https://test-instanz-netlify-functions.netlify.app/.netlify/functions/upload', {
      method: 'post',
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        name: file.name || 'defaultparameter',
      })
    })
    .then(response => response.json())
    .then(response => console.log(response));
    
  })
  
  const metadata = document.querySelector('.js-file-data');
  const fileSelector = document.getElementById('file-selector');
  fileSelector.addEventListener('change', (event) => {
    const fileList = event.target.files;
    getMetadataForFileList(fileList)
    console.log(fileList);
  });

  function getMetadataForFileList(fileList) {
    for (const file of fileList) {
      // Not supported in Safari for iOS.
      const name = file.name ? file.name : 'NOT SUPPORTED';
      // Not supported in Firefox for Android or Opera for Android.
      const type = file.type ? file.type : 'NOT SUPPORTED';
      // Unknown cross-browser support.
      const size = file.size ? file.size : 'NOT SUPPORTED';

      metadata.innerHTML += `<li>${name}, ${type}, ${size}</li>`
      console.log({file, name, type, size});
    }
  }

</script>